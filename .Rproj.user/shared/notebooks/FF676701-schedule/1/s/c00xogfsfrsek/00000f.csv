"0","library(tidyverse)"
"0","library(glue)"
"0","library(knitr)"
"0","library(kableExtra)"
"0",""
"0","# withr::with_dir(here::here(), {"
"0","#   targets::tar_load(schedule_file)"
"0","# })"
"0",""
"0","schedule_raw <- read.csv(""data/schedule.csv"", sep = "";"", encoding = ""latin1"", na.strings = c("""", ""NA""))"
"0",""
"0","schedule <- schedule_raw %>%"
"0","  mutate(group = fct_inorder(group)) %>%"
"0","  mutate(subgroup = fct_inorder(subgroup)) %>%"
"0","  mutate(var_title = ifelse(!is.na(content),"
"0","                            glue('<span class=""content-title"">{title}</span>'),"
"0","                            glue('{title}'))) %>%"
"0","  mutate(var_deadline = ifelse(!is.na(deadline),"
"0","                               glue('&emsp;&emsp;<small>(enviar antes de {deadline})</small>'),"
"0","                               """")) %>%"
"0","  mutate(var_content = ifelse(!is.na(content),"
"0","                              glue('<a href=""{content}.qmd""><i class=""fa-solid fa-book-open-reader fa-lg""></i></a>'),"
"0","                              glue('<font color=""#e9ecef""><i class=""fa-solid fa-book-open-reader fa-lg""></i></font>'))) %>%"
"0","  mutate(var_example = ifelse(!is.na(example),"
"0","                              glue('<a href=""{example}.qmd""><i class=""fa-solid fa-laptop-code fa-lg""></i></a>'),"
"0","                              glue('<font color=""#e9ecef""><i class=""fa-solid fa-laptop-code fa-lg""></i></font>'))) %>%"
"0","  mutate(var_assignment = ifelse(!is.na(assignment),"
"0","                                 glue('<a href=""{assignment}.qmd""><i class=""fa-solid fa-pen-ruler fa-lg""></i></a>'),"
"0","                                 glue('<font color=""#e9ecef""><i class=""fa-solid fa-pen-ruler fa-lg""></i></font>'))) %>%"
"0","  mutate(col_date = ifelse(is.na(date_end),"
"0","                           glue('<strong>{format(date, format = ""%d/%m/%y"")}</strong>'),"
"0","                           glue('<strong>{format(date, format = ""%d/%m/%y"")}</strong>–<strong>{format(date_end, format = ""%d/%m/%y"")}</strong>'))) %>%"
"0","  mutate(col_title = glue('{var_title}{var_deadline}')) %>%"
"0","  mutate(col_content = var_content,"
"0","         col_example = var_example,"
"0","         col_assignment = var_assignment)"
"0",""
"0","schedule_nested <- schedule %>%"
"0","  select(group, subgroup,"
"0","         ` ` = col_date, `Título` = col_title, Contenido = col_content,"
"0","         Ejemplo = col_example, Tarea = col_assignment) %>%"
"0","  group_by(group) %>%"
"0","  nest() %>%"
"0","  mutate(subgroup_count = map(data, ~count(.x, subgroup)),"
"0","         subgroup_index = map(subgroup_count, ~{"
"0","           .x %>% pull(n) %>% set_names(.x$subgroup)"
"0","         }))"
"0",""
"0","show_table <- function(group_id) {"
"0","  # Add a heading"
"0","  cat(as.character(paste(""\n\n###"", schedule_nested$group[[group_id]], ""\n\n"")))"
"0",""
"0","  # Make the table"
"0","  tbl <- schedule_nested$data[[group_id]] %>%"
"0","    select(-subgroup) %>%"
"0","    kbl(escape = FALSE, align = ""rlccc"", table.attr = 'class=""schedule-table""') %>%"
"0","    kable_styling() %>%"
"0","    column_spec(1, width = ""20%"", extra_css = ""padding-right: 20px;"") %>%"
"0","    column_spec(2, width = ""50%"") %>%"
"0","    column_spec(3:5, width = ""10%"") %>%"
"0","    pack_rows(index = schedule_nested$subgroup_index[[group_id]],"
"0","              label_row_css = ""border-bottom: 2px solid #000000;"")"
"0",""
"0","  cat(tbl)"
"0","}"
